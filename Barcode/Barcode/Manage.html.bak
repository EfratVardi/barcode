<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title> ממשק ניהול</title>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
    <!-- https://cdnjs.com/libraries/FileSaver.js -->
    <!-- https://github.com/eligrey/FileSaver.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script type="text/javascript">
        var json_object;

        var ExcelToJSON = function () {
           // localStorage.setItem("1", "");
            //localStorage.setItem("2", "");
            //localStorage.setItem("3", "");
            //localStorage.setItem("4", "");
            //localStorage.setItem("5", "");
            //localStorage.setItem("6", "");
			//localStorage.setItem("7", "");
            //localStorage.setItem("8", "");

           // localStorage.setItem("undefined", "");


            this.parseExcel = function (file) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    var data = e.target.result;
                    var workbook = XLSX.read(data, {
                        type: 'binary'
                    });
                    workbook.SheetNames.forEach(function (sheetName) {
                        // Here is your object
                        var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
                        json_object = JSON.stringify(XL_row_object);
                        if (localStorage.getItem("students") == null) {
                            localStorage.setItem("students", "");
                        }
                        localStorage["students"] = json_object;
                        console.log(json_object);
                        //jQuery('#xlx_json').val(json_object);
                    })
                };

                reader.onerror = function (ex) {
                    console.log(ex);
                };

                reader.readAsBinaryString(file);
            };
        };

        function handleFileSelect(evt) {

            var files = evt.target.files; // FileList object
            var xl2json = new ExcelToJSON();
            xl2json.parseExcel(files[0]);
        }
        function downloadfile() {

            var BOM = String.fromCharCode(0xFEFF);

            var content1 = BOM + localStorage.getItem("1");
            var content2 = BOM + localStorage.getItem("2");
            var content3 = BOM + localStorage.getItem("3");
            var content4 = BOM + localStorage.getItem("4");
            var content5 = BOM + localStorage.getItem("5");
            var content6 = BOM + localStorage.getItem("6");
            var content7 = BOM + localStorage.getItem("7");
            var content8 = BOM + localStorage.getItem("8");
            var content9=BOM + localStorage.getItem("sumPoints");
            //1
            var myBlob = new Blob([content1], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "1.txt";
            anchor.click();
            //window.URL.revokeObjectURL(url);
            ////document.removeChild(anchor);

            //2
            var myBlob = new Blob([content2], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "2.txt";
            anchor.click();

            //3
            var myBlob = new Blob([content3], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "3.txt";
            anchor.click();

            //4
            var myBlob = new Blob([content4], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "4.txt";
            anchor.click();

            //5
            var myBlob = new Blob([content5], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "5.txt";
            anchor.click();

            //6
            var myBlob = new Blob([content6], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "6.txt";
            anchor.click();
			
			//7
			 var myBlob = new Blob([content7], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "7.txt";
            anchor.click();
			
			//8
			 var myBlob = new Blob([content8], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "8.txt";
            anchor.click();
        };
		
		//9
			 var myBlob = new Blob([content9], { type: "text/plain;charset=utf-8" });
            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "points.txt";
            anchor.click();
        };

    </script>
	   <section id="sec1" style="background-image: url('background.jpg');  z-index: -1; position: absolute;background-size:100%; width: 1350px; height: 750px;"></section>

    <section style="
        width: 1200px;
        height: 650px;
        background-color: #ffffff;
        opacity: 0.4;
        filter: alpha(opacity=40);
        float: left;
        margin-left: 60px;
        margin-top: 50px">
        <p style="color: black; text-align:center;font-size:50px;font-weight:400" id="line1"> ברוכה הבאה לממשק ניהול</p>
        <button id="btn"
                style="
        width: 600px;
        height: 350px;
        background-color: transparent;
        background-image: url(up.gif);
        background-size: 550px;
        margin-left: 325px;
        border:none
    "></button>
        
        
           

        <span style="margin-left:400px">
            <button onclick="downloadfile()" >הורדת נתונים</button>
            <input id="upload" type=file name="files[]" style="margin-left:200px";
>
        </span>
        



     
        <!--<button onclick="downloadfile()">הורד נתונים</button>-->
    </section>
    <script>
        document.getElementById('upload').addEventListener('change', handleFileSelect, false);
    </script>
    <style>
        section {
            font-family: Fb Magnolia;
            font-style: normal;
            font-variant: normal;
            line-height: 26.4px;
        }
    </style>
</body>
</html>